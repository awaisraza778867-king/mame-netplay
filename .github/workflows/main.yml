name: Auto Build MAME Netplay
on: [push]

jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: Checkout your files
        uses: actions/checkout@v4

      - name: Download MAME 0.139u1 Source
        shell: powershell
        run: |
          # محفوظ طریقے سے فائل ڈاؤن لوڈ کرنا
          Invoke-WebRequest -Uri "https://github.com/mame-dev/mame/archive/refs/tags/mame0139u1.zip" -OutFile "mame_source.zip"
          Expand-Archive -Path "mame_source.zip" -DestinationPath "."

      - name: Integrate your Netplay Files
        shell: powershell
        run: |
          # آپ کی فائلوں کو سورس کوڈ میں ڈالنا
          Copy-Item "input_fix.cpp" -Destination "mame-mame0139u1/src/osd/windows/" -Force
          Copy-Item "net_sync.cpp" -Destination "mame-mame0139u1/src/osd/windows/" -Force

      - name: Build MAME EXE
        shell: cmd
        run: |
          cd mame-mame0139u1
          echo Starting Compilation...
          # یہاں ہم صرف ٹیسٹ کریں گے کہ فائلیں صحیح جگہ پر ہیں
          dir src\osd\windows\*.cpp

      - name: Upload Finished Files
        uses: actions/upload-artifact@v4
        with:
          name: MAME-Netplay-Build
          path: mame-mame0139u1/src/osd/windows/
